{"meta":{"title":"showteeth's blog","subtitle":null,"description":null,"author":"showteeth","url":"http://showteeth.tech"},"pages":[{"title":"","date":"2019-02-17T05:56:27.181Z","updated":"2019-02-17T05:56:27.181Z","comments":true,"path":"about/index.html","permalink":"http://showteeth.tech/about/index.html","excerpt":"","text":"This is a self-introduce pageUnder construction"},{"title":"categories","date":"2019-02-19T09:38:27.000Z","updated":"2019-02-19T16:27:19.660Z","comments":false,"path":"categories/index.html","permalink":"http://showteeth.tech/categories/index.html","excerpt":"","text":""},{"title":"","date":"2019-02-19T16:02:08.886Z","updated":"2019-02-19T16:02:08.886Z","comments":true,"path":"photos/data.json","permalink":"http://showteeth.tech/photos/data.json","excerpt":"","text":"{\"list\":[{\"date\":\"2009-09\",\"arr\":{\"year\":2009,\"month\":9,\"link\":[\"2009-09-26_test5.jpg\",\"2009-09-26_test2.jpg\"],\"text\":[\"test5\",\"test2\"],\"type\":[\"image\",\"image\"]}},{\"date\":\"2007-05\",\"arr\":{\"year\":2007,\"month\":5,\"link\":[\"2007-05-28_test3.jpg\"],\"text\":[\"test3\"],\"type\":[\"image\"]}},{\"date\":\"2006-11\",\"arr\":{\"year\":2006,\"month\":11,\"link\":[\"2006-11-22_test4.jpg\"],\"text\":[\"test4\"],\"type\":[\"image\"]}},{\"date\":\"2005-07\",\"arr\":{\"year\":2005,\"month\":7,\"link\":[\"2005-07-17_test1.jpg\"],\"text\":[\"test1\"],\"type\":[\"image\"]}}]}"},{"title":"相册","date":"2019-02-19T14:40:29.000Z","updated":"2019-02-19T15:57:21.505Z","comments":true,"path":"photos/index.html","permalink":"http://showteeth.tech/photos/index.html","excerpt":"","text":"Photos图片正在加载中…setTimeout(function(){var e,t;e=\"ins.js\",t=document.createElement(\"script\"),document.getElementsByTagName(\"body\")[0].appendChild(t),t.setAttribute(\"src\",e)},0)"},{"title":"","date":"2019-02-19T14:45:22.084Z","updated":"2018-09-01T23:27:30.000Z","comments":true,"path":"photos/ins.css","permalink":"http://showteeth.tech/photos/ins.css","excerpt":"","text":"#post-instagram{padding:30px}figure{margin:0}#post-instagram .article-entry{padding-right:0}.instagram{position:relative;min-height:500px}.instagram img{width:100%}.posts-expand .post-body img{padding:0;border:0}.instagram .year{font-size:16px}.instagram .open-ins{padding:10px 0;color:#cdcdcd}.instagram .open-ins:hover{color:#657b83}.instagram .year{display:inline}.instagram .thumb{width:25%;height:0;padding-bottom:25%;position:relative;display:inline-block;text-align:center;background:#ededed;outline:1px solid #ddd}.instagram .thumb a{position:relative}.instagram .album h1 em{font-style:normal;font-size:14px;margin-left:10px}.instagram .album ul{display:flex;flex-wrap:wrap;clear:both;width:100%;text-align:left}.instagram .album li{list-style:none;display:inline-block;box-sizing:border-box;padding:0 5px;margin-bottom:-10px;height:0;width:25%;position:relative;padding-bottom:25%}.instagram .album li:before{display:none}.instagram .album div.img-box{position:absolute;width:90%;height:90%;box-shadow:0 1px 0 rgba(255,255,255,.4),0 1px 0 1px rgba(255,255,255,.1)}.instagram .album div.img-box img{width:100%;height:100%;position:absolute;z-index:2}.instagram .album div.img-box .img-bg{position:absolute;top:0;left:0;bottom:0;width:100%;margin:-5px;padding:5px;box-shadow:0 0 0 1px rgba(0,0,0,.04),0 1px 5px rgba(0,0,0,.1);transition:all .15s ease-out .1s;opacity:.2;cursor:pointer;display:block;z-index:3}.instagram .album div.img-box .icon{font-size:14px;position:absolute;left:50%;top:50%;margin-left:-7px;margin-top:-7px;color:#999;z-index:1}.instagram .album div.img-box .img-bg:hover{opacity:0}.photos-btn-wrap{border-bottom:1px solid #e5e5e5;margin-bottom:20px}.photos-btn{font-size:16px;color:#333;margin-bottom:-4px;padding:5px 8px 3px}.photos-btn.active{color:#08c;border:1px solid #e5e5e5;border-bottom:5px solid #fff}@media screen and (max-width:600px){.instagram .thumb{width:50%;padding-bottom:50%}.instagram .album li{width:100%;position:relative;padding-bottom:100%;text-align:center}.instagram .album div.img-box{margin:0;width:90%;height:90%}}"},{"title":"","date":"2019-02-19T14:45:22.101Z","updated":"2018-09-01T23:27:30.000Z","comments":true,"path":"photos/photoswipe.css","permalink":"http://showteeth.tech/photos/photoswipe.css","excerpt":"","text":"/*! PhotoSwipe main CSS by Dmitry Semenov | photoswipe.com | MIT license */.pswp{display:none;position:absolute;width:100%;height:100%;left:0;top:0;overflow:hidden;touch-action:none;z-index:1500;-webkit-text-size-adjust:100%;-webkit-backface-visibility:hidden;outline:0}.pswp *{box-sizing:border-box}.pswp img{max-width:none}.pswp--animate_opacity{opacity:.001;will-change:opacity;transition:opacity 333ms cubic-bezier(.4,0,.22,1)}.pswp--open{display:block}.pswp--zoom-allowed .pswp__img{cursor:zoom-in}.pswp--zoomed-in .pswp__img{cursor:-webkit-grab;cursor:grab}.pswp--dragging .pswp__img{cursor:-webkit-grabbing;cursor:grabbing}.pswp__bg{position:absolute;left:0;top:0;width:100%;height:100%;background:#000;opacity:0;-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-backface-visibility:hidden;will-change:opacity}.pswp__scroll-wrap{position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden}.pswp__container,.pswp__zoom-wrap{touch-action:none;position:absolute;left:0;right:0;top:0;bottom:0}.pswp__container,.pswp__img{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}.pswp__zoom-wrap{position:absolute;width:100%;-webkit-transform-origin:left top;transform-origin:left top;transition:-webkit-transform 333ms cubic-bezier(.4,0,.22,1);transition:transform 333ms cubic-bezier(.4,0,.22,1);transition:transform 333ms cubic-bezier(.4,0,.22,1), -webkit-transform 333ms cubic-bezier(.4,0,.22,1)}.pswp__bg{will-change:opacity;transition:opacity 333ms cubic-bezier(.4,0,.22,1)}.pswp--animated-in .pswp__bg,.pswp--animated-in .pswp__zoom-wrap{transition:none}.pswp__container,.pswp__zoom-wrap{-webkit-backface-visibility:hidden}.pswp__item{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden}.pswp__img{position:absolute;width:auto;height:auto;top:0;left:0}.pswp__img--placeholder{-webkit-backface-visibility:hidden}.pswp__img--placeholder--blank{background:#222}.pswp--ie .pswp__img{width:100%!important;height:auto!important;left:0;top:0}.pswp__error-msg{position:absolute;left:0;top:50%;width:100%;text-align:center;font-size:14px;line-height:16px;margin-top:-8px;color:#ccc}.pswp__error-msg a{color:#ccc;text-decoration:underline}"},{"title":"","date":"2019-02-17T05:56:14.120Z","updated":"2019-02-17T05:56:14.120Z","comments":true,"path":"projects/index.html","permalink":"http://showteeth.tech/projects/index.html","excerpt":"","text":"This is a project pageUnder construction"},{"title":"tags","date":"2019-02-19T09:37:21.000Z","updated":"2019-02-19T16:27:34.089Z","comments":false,"path":"tags/index.html","permalink":"http://showteeth.tech/tags/index.html","excerpt":"","text":""},{"title":"","date":"2019-02-19T11:25:33.167Z","updated":"2019-02-19T11:25:33.167Z","comments":true,"path":"top/index.html","permalink":"http://showteeth.tech/top/index.html","excerpt":"","text":"AV.initialize(\"leancloud_appid\",\"leancloud_appkey\")var time=0,title=\"\",url=\"\",query=new AV.Query(\"Counter\");query.notEqualTo(\"id\",0),query.descending(\"time\"),query.limit(1e3),query.find().then(function(e){for(var t=0;t"},{"title":"","date":"2019-02-19T15:47:13.702Z","updated":"2019-02-19T15:47:13.702Z","comments":true,"path":"photos/ins.js","permalink":"http://showteeth.tech/photos/ins.js","excerpt":"","text":"/******/ (function(modules) { // webpackBootstrap /******/ // The module cache /******/ var installedModules = {}; /******/ /******/ // The require function /******/ function __webpack_require__(moduleId) { /******/ /******/ // Check if module is in cache /******/ if (installedModules[moduleId]) /******/ return installedModules[moduleId].exports; /******/ /******/ // Create a new module (and put it into the cache) /******/ var module = installedModules[moduleId] = { /******/ exports: {}, /******/ id: moduleId, /******/ loaded: false /******/ }; /******/ /******/ // Execute the module function /******/ modules[moduleId].call(module.exports, module, module.exports, __webpack_require__); /******/ /******/ // Flag the module as loaded /******/ module.loaded = true; /******/ /******/ // Return the exports of the module /******/ return module.exports; /******/ } /******/ /******/ /******/ // expose the modules object (__webpack_modules__) /******/ __webpack_require__.m = modules; /******/ /******/ // expose the module cache /******/ __webpack_require__.c = installedModules; /******/ /******/ // __webpack_public_path__ /******/ __webpack_require__.p = \"/dist/\"; /******/ /******/ // Load entry module and return exports /******/ return __webpack_require__(0); /******/ }) /************************************************************************/ /******/ ([ /* 0 */ /***/ function(module, exports, __webpack_require__) { 'use strict'; __webpack_require__(1); var _view = __webpack_require__(2); var _view2 = _interopRequireDefault(_view); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } /** * @name impush-client * @description 这个项目让我发家致富… * @date 2016-12-1 */ var _collection = []; var _count = 0; var searchData; function addMask(elem) { var rect = elem.getBoundingClientRect(); var style = getComputedStyle(elem, null); var mask = document.createElement('i'); mask.className = 'icon-film'; mask.style.color = '#fff'; mask.style.fontSize = '26px'; mask.style.position = 'absolute'; mask.style.right = '10px'; mask.style.bottom = '10px'; mask.style.zIndex = 1; elem.parentNode.appendChild(mask); } var createVideoIncon = function createVideoIncon() { var $videoImg = document.querySelectorAll('.thumb a[data-type=\"video\"]'); for (var i = 0, len = $videoImg.length; i < len; i++) { addMask($videoImg[i]); } }; var render = function render(res) { var ulTmpl = \"\"; for (var j = 0, len2 = res.list.length; j < len2; j++) { var data = res.list[j].arr; var liTmpl = \"\"; for (var i = 0, len = data.link.length; i < len; i++) { //var minSrc = 'https://raw.githubusercontent.com/yourgithub/Blog_Album/master/min_photos/' + data.link[i]; var minSrc = 'https://raw.githubusercontent.com/showteeth/Blog_Album/master/min_photos/' + data.link[i]; // var src = 'https://raw.githubusercontent.com/yourgithub/Blog_Album/master/photos/' + data.link[i]; var src = 'https://raw.githubusercontent.com/showteeth/Blog_Album/master/photos/' + data.link[i]; var type = data.type[i]; var target = src + (type === 'video' ? '.mp4' : '.jpg'); liTmpl += '\\ \\ \\ \\ ' + data.text[i] + '\\ '; } ulTmpl = ulTmpl + '' + data.year + '年' + data.month + '月\\ ' + liTmpl + '\\ '; } document.querySelector('.instagram').innerHTML = '' + ulTmpl + ''; createVideoIncon(); _view2.default.init(); }; var replacer = function replacer(str) { var arr = str.split(\"/\"); return \"/assets/ins/\" + arr[arr.length - 1]; }; var ctrler = function ctrler(data) { var imgObj = {}; for (var i = 0, len = data.length; i < len; i++) { var y = data[i].y; var m = data[i].m; var src = replacer(data[i].src); var text = data[i].text; var key = y + \"\" + ((m + \"\").length == 1 ? \"0\" + m : m); if (imgObj[key]) { imgObj[key].srclist.push(src); imgObj[key].text.push(text); } else { imgObj[key] = { year: y, month: m, srclist: [src], text: [text] }; } } render(imgObj); }; function loadData(success) { if (!searchData) { var xhr = new XMLHttpRequest(); xhr.open('GET', 'data.json?t=' + +new Date(), true); xhr.onload = function() { if (this.status >= 200 && this.status < 300) { var res = JSON.parse(this.response); searchData = res; success(searchData); } else { console.error(this.statusText); } }; xhr.onerror = function() { console.error(this.statusText); }; xhr.send(); } else { success(searchData); } } var Ins = { init: function init() { loadData(function(data) { render(data); }); } }; Ins.init(); // export default impush; /***/ }, /* 1 */ /***/ function(module, exports, __webpack_require__) { /* WEBPACK VAR INJECTION */ (function(global) { 'use strict'; var inViewport = __webpack_require__(3); var lazyAttrs = ['data-src']; global.lzld = lazyload(); // Provide libs using getAttribute early to get the good src // and not the fake data-src replaceGetAttribute('Image'); replaceGetAttribute('IFrame'); function registerLazyAttr(attr) { if (indexOf.call(lazyAttrs, attr) === -1) { lazyAttrs.push(attr); } } function lazyload(opts) { //console.log(\"lazyload\") opts = merge({ 'offset': 333, 'src': 'data-src', 'container': false }, opts || {}); if (typeof opts.src === 'string') { registerLazyAttr(opts.src); } var elts = []; function show(elt) { var src = findRealSrc(elt); if (src) { elt.src = src; } elt.setAttribute('data-lzled', true); elts[indexOf.call(elts, elt)] = null; } function findRealSrc(elt) { if (typeof opts.src === 'function') { return opts.src(elt); } return elt.getAttribute(opts.src); } function register(elt) { elt.onload = null; elt.removeAttribute('onload'); elt.onerror = null; elt.removeAttribute('onerror'); if (indexOf.call(elts, elt) === -1) { inViewport(elt, opts, show); } } return register; } function replaceGetAttribute(elementName) { var fullname = 'HTML' + elementName + 'Element'; if (fullname in global === false) { return; } var original = global[fullname].prototype.getAttribute; global[fullname].prototype.getAttribute = function(name) { if (name === 'src') { var realSrc; for (var i = 0, max = lazyAttrs.length; i < max; i++) { realSrc = original.call(this, lazyAttrs[i]); if (realSrc) { break; } } return realSrc || original.call(this, name); } // our own lazyloader will go through theses lines // because we use getAttribute(opts.src) return original.call(this, name); }; } function merge(defaults, opts) { for (var name in defaults) { if (opts[name] === undefined) { opts[name] = defaults[name]; } } return opts; } // http://webreflection.blogspot.fr/2011/06/partial-polyfills.html function indexOf(value) { for (var i = this.length; i-- && this[i] !== value;) {} return i; } module.exports = lazyload; // export default impush; /* WEBPACK VAR INJECTION */ }.call(exports, (function() { return this; }()))) /***/ }, /* 2 */ /***/ function(module, exports) { 'use strict'; var initPhotoSwipeFromDOM = function initPhotoSwipeFromDOM(gallerySelector) { // parse slide data (url, title, size ...) from DOM elements // (children of gallerySelector) var parseThumbnailElements = function parseThumbnailElements(el) { el = el.parentNode.parentNode; var thumbElements = el.getElementsByClassName('thumb'), numNodes = thumbElements.length, items = [], figureEl, linkEl, size, type, // video or not target, item; for (var i = 0; i < numNodes; i++) { figureEl = thumbElements[i]; // // include only element nodes if (figureEl.nodeType !== 1) { continue; } linkEl = figureEl.children[0]; // size = linkEl.getAttribute('data-size').split('x'); type = linkEl.getAttribute('data-type'); target = linkEl.getAttribute('data-target'); // create slide object item = { src: linkEl.getAttribute('href'), w: parseInt(size[0], 10), h: parseInt(size[1], 10) }; if (figureEl.children.length > 1) { item.title = figureEl.children[1].innerHTML; } if (linkEl.children.length > 0) { item.msrc = linkEl.children[0].getAttribute('src'); item.type = type; item.target = target; item.html = ''; if (type === 'video') { //item.src = null; } } item.el = figureEl; // save link to element for getThumbBoundsFn items.push(item); } return items; }; // find nearest parent element var closest = function closest(el, fn) { return el && (fn(el) ? el : closest(el.parentNode, fn)); }; // triggers when user clicks on thumbnail var onThumbnailsClick = function onThumbnailsClick(e) { e = e || window.event; e.preventDefault ? e.preventDefault() : e.returnValue = false; var eTarget = e.target || e.srcElement; // find root element of slide var clickedListItem = closest(eTarget, function(el) { return el.tagName && el.tagName.toUpperCase() === 'FIGURE'; }); if (!clickedListItem) { return; } // find index of clicked item by looping through all child nodes // alternatively, you may define index via data- attribute var clickedGallery = clickedListItem.parentNode, // childNodes = clickedListItem.parentNode.childNodes, // numChildNodes = childNodes.length, childNodes = document.getElementsByClassName('thumb'), numChildNodes = childNodes.length, nodeIndex = 0, index; for (var i = 0; i < numChildNodes; i++) { if (childNodes[i].nodeType !== 1) { continue; } if (childNodes[i] === clickedListItem) { index = nodeIndex; break; } nodeIndex++; } if (index >= 0) { // open PhotoSwipe if valid index found openPhotoSwipe(index, clickedGallery); } return false; }; // parse picture index and gallery index from URL (#&pid=1&gid=2) var photoswipeParseHash = function photoswipeParseHash() { var hash = window.location.hash.substring(1), params = {}; if (hash.length < 5) { return params; } var vars = hash.split('&'); for (var i = 0; i < vars.length; i++) { if (!vars[i]) { continue; } var pair = vars[i].split('='); if (pair.length < 2) { continue; } params[pair[0]] = pair[1]; } if (params.gid) { params.gid = parseInt(params.gid, 10); } return params; }; var openPhotoSwipe = function openPhotoSwipe(index, galleryElement, disableAnimation, fromURL) { var pswpElement = document.querySelectorAll('.pswp')[0], gallery, options, items; items = parseThumbnailElements(galleryElement); // define options (if needed) options = { // define gallery index (for URL) galleryUID: galleryElement.getAttribute('data-pswp-uid'), getThumbBoundsFn: function getThumbBoundsFn(index) { // See Options -> getThumbBoundsFn section of documentation for more info var thumbnail = items[index].el.getElementsByTagName('img')[0], // find thumbnail pageYScroll = window.pageYOffset || document.documentElement.scrollTop, rect = thumbnail.getBoundingClientRect(); return { x: rect.left, y: rect.top + pageYScroll, w: rect.width }; } }; // PhotoSwipe opened from URL if (fromURL) { if (options.galleryPIDs) { // parse real index when custom PIDs are used // http://photoswipe.com/documentation/faq.html#custom-pid-in-url for (var j = 0; j < items.length; j++) { if (items[j].pid == index) { options.index = j; break; } } } else { // in URL indexes start from 1 options.index = parseInt(index, 10) - 1; } } else { options.index = parseInt(index, 10); } // exit if index not found if (isNaN(options.index)) { return; } if (disableAnimation) { options.showAnimationDuration = 0; } // Pass data to PhotoSwipe and initialize it gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options); gallery.init(); var $tempVideo; var stopVideoHandle = function stopVideoHandle() { if ($tempVideo) { $tempVideo.remove(); $tempVideo = null; } }; var changeHandle = function changeHandle() { var item = gallery.currItem; stopVideoHandle(); if (item.type === 'video') { var $ctn = item.container; var style = $ctn.getElementsByClassName('pswp__img')[0].style; var $video = document.createElement('video'); $video.setAttribute('autoplay', 'autoplay'); $video.setAttribute('controls', 'controls'); $video.setAttribute('src', item.target); $video.style.width = style.width; $video.style.height = style.height; $video.style.position = 'absolute'; $video.style.zIndex = 2; $tempVideo = $video; $ctn.appendChild($video); } }; gallery.listen('initialZoomIn', changeHandle); gallery.listen('afterChange', changeHandle); gallery.listen('initialZoomOut', stopVideoHandle); }; // loop through all gallery elements and bind events var galleryElements = document.querySelectorAll(gallerySelector); for (var i = 0, l = galleryElements.length; i < l; i++) { galleryElements[i].setAttribute('data-pswp-uid', i + 1); galleryElements[i].onclick = onThumbnailsClick; } // Parse URL and open gallery if it contains #&pid=3&gid=1 var hashData = photoswipeParseHash(); if (hashData.pid && hashData.gid) { openPhotoSwipe(hashData.pid, galleryElements[hashData.gid - 1], true, true); } }; var Viewer = function() { function init() { initPhotoSwipeFromDOM('.photos'); } return { init: init }; }(); module.exports = Viewer; /***/ }, /* 3 */ /***/ function(module, exports) { /* WEBPACK VAR INJECTION */ (function(global) { module.exports = inViewport; var instances = []; var supportsMutationObserver = typeof global.MutationObserver === 'function'; function inViewport(elt, params, cb) { var opts = { container: global.document.body, offset: 0 }; if (params === undefined || typeof params === 'function') { cb = params; params = {}; } var container = opts.container = params.container || opts.container; var offset = opts.offset = params.offset || opts.offset; for (var i = 0; i < instances.length; i++) { if (instances[i].container === container) { return instances[i].isInViewport(elt, offset, cb); } } return instances[ instances.push(createInViewport(container)) - 1 ].isInViewport(elt, offset, cb); } function addEvent(el, type, fn) { if (el.attachEvent) { el.attachEvent('on' + type, fn); } else { el.addEventListener(type, fn, false); } } function debounce(func, wait, immediate) { var timeout; return function() { var context = this, args = arguments; var callNow = immediate && !timeout; clearTimeout(timeout); timeout = setTimeout(later, wait); if (callNow) func.apply(context, args); function later() { timeout = null; if (!immediate) func.apply(context, args); } }; } // https://github.com/jquery/sizzle/blob/3136f48b90e3edc84cbaaa6f6f7734ef03775a07/sizzle.js#L708 var contains = function() { if (!global.document) { return true; } return global.document.documentElement.compareDocumentPosition ? function(a, b) { return !!(a.compareDocumentPosition(b) & 16); } : global.document.documentElement.contains ? function(a, b) { return a !== b && (a.contains ? a.contains(b) : false); } : function(a, b) { while (b = b.parentNode) { if (b === a) { return true; } } return false; }; } function createInViewport(container) { var watches = createWatches(); var scrollContainer = container === global.document.body ? global : container; var debouncedCheck = debounce(watches.checkAll(watchInViewport), 15); addEvent(scrollContainer, 'scroll', debouncedCheck); if (scrollContainer === global) { addEvent(global, 'resize', debouncedCheck); } if (supportsMutationObserver) { observeDOM(watches, container, debouncedCheck); } // failsafe check, every 200ms we check for visible images // usecase: a hidden parent containing eleements // when the parent becomes visible, we have no event that the children // became visible setInterval(debouncedCheck, 150); function isInViewport(elt, offset, cb) { if (!cb) { return isVisible(elt, offset); } var remote = createRemote(elt, offset, cb); remote.watch(); return remote; } function createRemote(elt, offset, cb) { function watch() { watches.add(elt, offset, cb); } function dispose() { watches.remove(elt); } return { watch: watch, dispose: dispose }; } function watchInViewport(elt, offset, cb) { if (isVisible(elt, offset)) { watches.remove(elt); cb(elt); } } function isVisible(elt, offset) { if (!contains(global.document.documentElement, elt) || !contains(global.document.documentElement, container)) { return false; } // Check if the element is visible // https://github.com/jquery/jquery/blob/740e190223d19a114d5373758127285d14d6b71e/src/css/hiddenVisibleSelectors.js if (!elt.offsetWidth || !elt.offsetHeight) { return false; } var eltRect = elt.getBoundingClientRect(); var viewport = {}; if (container === global.document.body) { viewport = { top: -offset, left: -offset, right: global.document.documentElement.clientWidth + offset, bottom: global.document.documentElement.clientHeight + offset }; } else { var containerRect = container.getBoundingClientRect(); viewport = { top: containerRect.top - offset, left: containerRect.left - offset, right: containerRect.right + offset, bottom: containerRect.bottom + offset }; } // The element must overlap with the visible part of the viewport var visible = ( (eltRect.right > viewport.left) && (eltRect.left < viewport.right) && (eltRect.bottom > viewport.top) && (eltRect.top < viewport.bottom) ); return visible; } return { container: container, isInViewport: isInViewport }; } function createWatches() { var watches = []; function add(elt, offset, cb) { if (!isWatched(elt)) { watches.push([elt, offset, cb]); } } function remove(elt) { var pos = indexOf(elt); if (pos !== -1) { watches.splice(pos, 1); } } function indexOf(elt) { for (var i = watches.length - 1; i >= 0; i--) { if (watches[i][0] === elt) { return i; } } return -1; } function isWatched(elt) { return indexOf(elt) !== -1; } function checkAll(cb) { return function() { for (var i = watches.length - 1; i >= 0; i--) { cb.apply(this, watches[i]); } }; } return { add: add, remove: remove, isWatched: isWatched, checkAll: checkAll }; } function observeDOM(watches, container, cb) { var observer = new MutationObserver(watch); var filter = Array.prototype.filter; var concat = Array.prototype.concat; observer.observe(container, { childList: true, subtree: true, // changes like style/width/height/display will be catched attributes: true }); function watch(mutations) { // some new DOM nodes where previously watched // we should check their positions if (mutations.some(knownNodes) === true) { setTimeout(cb, 0); } } function knownNodes(mutation) { var nodes = concat.call([], Array.prototype.slice.call(mutation.addedNodes), mutation.target ); return filter.call(nodes, watches.isWatched).length > 0; } } /* WEBPACK VAR INJECTION */ }.call(exports, (function() { return this; }()))) /***/ } /******/ ]);"},{"title":"","date":"2019-02-19T14:45:22.068Z","updated":"2018-09-01T23:27:30.000Z","comments":true,"path":"photos/default-skin/default-skin.css","permalink":"http://showteeth.tech/photos/default-skin/default-skin.css","excerpt":"","text":"/*! PhotoSwipe Default UI CSS by Dmitry Semenov | photoswipe.com | MIT license */.pswp__button{width:44px;height:44px;position:relative;background:0 0;cursor:pointer;overflow:visible;-webkit-appearance:none;display:block;border:0;padding:0;margin:0;float:right;opacity:.75;transition:opacity .2s;box-shadow:none}.pswp__button:focus,.pswp__button:hover{opacity:1}.pswp__button:active{outline:0;opacity:.9}.pswp__button::-moz-focus-inner{padding:0;border:0}.pswp__ui--over-close .pswp__button--close{opacity:1}.pswp__button,.pswp__button--arrow--left:before,.pswp__button--arrow--right:before{background:url(default-skin.png) 0 0 no-repeat;background-size:264px 88px;width:44px;height:44px}@media (-webkit-min-device-pixel-ratio:1.1),(-webkit-min-device-pixel-ratio:1.09375),(min-resolution:105dpi),(min-resolution:1.1dppx){.pswp--svg .pswp__button,.pswp--svg .pswp__button--arrow--left:before,.pswp--svg .pswp__button--arrow--right:before{background-image:url(default-skin.svg)}.pswp--svg .pswp__button--arrow--left,.pswp--svg .pswp__button--arrow--right{background:0 0}}.pswp__button--close{background-position:0 -44px}.pswp__button--share{background-position:-44px -44px}.pswp__button--fs{display:none}.pswp--supports-fs .pswp__button--fs{display:block}.pswp--fs .pswp__button--fs{background-position:-44px 0}.pswp__button--zoom{display:none;background-position:-88px 0}.pswp--zoom-allowed .pswp__button--zoom{display:block}.pswp--zoomed-in .pswp__button--zoom{background-position:-132px 0}.pswp--touch .pswp__button--arrow--left,.pswp--touch .pswp__button--arrow--right{visibility:hidden}.pswp__button--arrow--left,.pswp__button--arrow--right{background:0 0;top:50%;margin-top:-50px;width:70px;height:100px;position:absolute}.pswp__button--arrow--left{left:0}.pswp__button--arrow--right{right:0}.pswp__button--arrow--left:before,.pswp__button--arrow--right:before{content:'';top:35px;background-color:rgba(0,0,0,.3);height:30px;width:32px;position:absolute}.pswp__button--arrow--left:before{left:6px;background-position:-138px -44px}.pswp__button--arrow--right:before{right:6px;background-position:-94px -44px}.pswp__counter,.pswp__share-modal{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.pswp__share-modal{display:block;background:rgba(0,0,0,.5);width:100%;height:100%;top:0;left:0;padding:10px;position:absolute;z-index:1600;opacity:0;transition:opacity .25s ease-out;-webkit-backface-visibility:hidden;will-change:opacity}.pswp__share-modal--hidden{display:none}.pswp__share-tooltip{z-index:1620;position:absolute;background:#fff;top:56px;border-radius:2px;display:block;width:auto;right:44px;box-shadow:0 2px 5px rgba(0,0,0,.25);-webkit-transform:translateY(6px);transform:translateY(6px);transition:-webkit-transform .25s;transition:transform .25s;transition:transform .25s, -webkit-transform .25s;-webkit-backface-visibility:hidden;will-change:transform}.pswp__share-tooltip a{display:block;padding:8px 12px;color:#000;text-decoration:none;font-size:14px;line-height:18px}.pswp__share-tooltip a:hover{text-decoration:none;color:#000}.pswp__share-tooltip a:first-child{border-radius:2px 2px 0 0}.pswp__share-tooltip a:last-child{border-radius:0 0 2px 2px}.pswp__share-modal--fade-in{opacity:1}.pswp__share-modal--fade-in .pswp__share-tooltip{-webkit-transform:translateY(0);transform:translateY(0)}.pswp--touch .pswp__share-tooltip a{padding:16px 12px}a.pswp__share--facebook:before{content:'';display:block;width:0;height:0;position:absolute;top:-12px;right:15px;border:6px solid transparent;border-bottom-color:#fff;-webkit-pointer-events:none;-moz-pointer-events:none;pointer-events:none}a.pswp__share--facebook:hover{background:#3e5c9a;color:#fff}a.pswp__share--facebook:hover:before{border-bottom-color:#3e5c9a}a.pswp__share--twitter:hover{background:#55acee;color:#fff}a.pswp__share--pinterest:hover{background:#ccc;color:#ce272d}a.pswp__share--download:hover{background:#ddd}.pswp__counter{position:absolute;left:0;top:0;height:44px;font-size:13px;line-height:44px;color:#fff;opacity:.75;padding:0 10px}.pswp__caption{position:absolute;left:0;bottom:0;width:100%;min-height:44px}.pswp__caption small{font-size:11px;color:#bbb}.pswp__caption__center{text-align:left;max-width:420px;margin:0 auto;font-size:13px;padding:10px;line-height:20px;color:#ccc}.pswp__caption--empty{display:none}.pswp__caption--fake{visibility:hidden}.pswp__preloader{width:44px;height:44px;position:absolute;top:0;left:50%;margin-left:-22px;opacity:0;transition:opacity .25s ease-out;will-change:opacity;direction:ltr}.pswp__preloader__icn{width:20px;height:20px;margin:12px}.pswp__preloader--active{opacity:1}.pswp__preloader--active .pswp__preloader__icn{background:url(preloader.gif) 0 0 no-repeat}.pswp--css_animation .pswp__preloader--active{opacity:1}.pswp--css_animation .pswp__preloader--active .pswp__preloader__icn{-webkit-animation:clockwise .5s linear infinite;animation:clockwise .5s linear infinite}.pswp--css_animation .pswp__preloader--active .pswp__preloader__donut{-webkit-animation:donut-rotate 1s cubic-bezier(.4,0,.22,1) infinite;animation:donut-rotate 1s cubic-bezier(.4,0,.22,1) infinite}.pswp--css_animation .pswp__preloader__icn{background:0 0;opacity:.75;width:14px;height:14px;position:absolute;left:15px;top:15px;margin:0}.pswp--css_animation .pswp__preloader__cut{position:relative;width:7px;height:14px;overflow:hidden}.pswp--css_animation .pswp__preloader__donut{box-sizing:border-box;width:14px;height:14px;border:2px solid #fff;border-radius:50%;border-left-color:transparent;border-bottom-color:transparent;position:absolute;top:0;left:0;background:0 0;margin:0}@media screen and (max-width:1024px){.pswp__preloader{position:relative;left:auto;top:auto;margin:0;float:right}}@-webkit-keyframes clockwise{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes clockwise{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes donut-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(-140deg);transform:rotate(-140deg)}100%{-webkit-transform:rotate(0);transform:rotate(0)}}@keyframes donut-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(-140deg);transform:rotate(-140deg)}100%{-webkit-transform:rotate(0);transform:rotate(0)}}.pswp__ui{-webkit-font-smoothing:auto;visibility:visible;opacity:1;z-index:1550}.pswp__top-bar{position:absolute;left:0;top:0;height:44px;width:100%}.pswp--has_mouse .pswp__button--arrow--left,.pswp--has_mouse .pswp__button--arrow--right,.pswp__caption,.pswp__top-bar{-webkit-backface-visibility:hidden;will-change:opacity;transition:opacity 333ms cubic-bezier(.4,0,.22,1)}.pswp--has_mouse .pswp__button--arrow--left,.pswp--has_mouse .pswp__button--arrow--right{visibility:visible}.pswp__caption,.pswp__top-bar{background-color:rgba(0,0,0,.5)}.pswp__ui--fit .pswp__caption,.pswp__ui--fit .pswp__top-bar{background-color:rgba(0,0,0,.3)}.pswp__ui--idle .pswp__top-bar{opacity:0}.pswp__ui--idle .pswp__button--arrow--left,.pswp__ui--idle .pswp__button--arrow--right{opacity:0}.pswp__ui--hidden .pswp__button--arrow--left,.pswp__ui--hidden .pswp__button--arrow--right,.pswp__ui--hidden .pswp__caption,.pswp__ui--hidden .pswp__top-bar{opacity:.001}.pswp__ui--one-slide .pswp__button--arrow--left,.pswp__ui--one-slide .pswp__button--arrow--right,.pswp__ui--one-slide .pswp__counter{display:none}.pswp__element--disabled{display:none!important}.pswp--minimal--dark .pswp__top-bar{background:0 0}"}],"posts":[{"title":"test-copyright","slug":"test-copyright","date":"2019-02-19T04:00:00.000Z","updated":"2019-02-19T04:01:03.116Z","comments":true,"path":"posts/37032.html","link":"","permalink":"http://showteeth.tech/posts/37032.html","excerpt":"Abstract:test copyright","text":"Abstract:test copyrightthis is title","categories":[],"tags":[]},{"title":"test_password","slug":"test-password","date":"2019-02-17T13:43:32.000Z","updated":"2019-02-19T04:13:06.783Z","comments":true,"path":"posts/30737.html","link":"","permalink":"http://showteeth.tech/posts/30737.html","excerpt":"Abstract:这是一篇用来测试加密文章的博客。","text":"function doDecrypt (pwd, onError) { console.log('in doDecrypt'); const txt = document.getElementById('enc_content').innerHTML; let plantext; try { const bytes = CryptoJS.AES.decrypt(txt, pwd); var plaintext = bytes.toString(CryptoJS.enc.Utf8); } catch(err) { if(onError) { onError(err); } return; } document.getElementById('enc_content').innerHTML = plaintext; document.getElementById('enc_content').style.display = 'block'; document.getElementById('enc_passwd').style.display = 'none'; if(typeof MathJax !== 'undefined') { MathJax.Hub.Queue( ['resetEquationNumbers', MathJax.InputJax.TeX], ['PreProcess', MathJax.Hub], ['Reprocess', MathJax.Hub] ); } } U2FsdGVkX19HDbPczkrPHg5pZibuUaWM/tLzojJNwCwHyqzUlM6/Z4oS5/0ncoIcf+7f0F2zg9Q3JnjMS78x7040iQn0lJWkWVupr+kFs0Skqm/sAnVtr4HqRqToPJsJFd92O2rsP06VEWyN5dzmQYb4ba7jrgc2Gt2d0PaEwWfspONTO8OyU7XISxui+wXujNla8Xn7xxr0MG3CQRRN7oeaWhqanvcl+fvD5LiR0V4GJxO8JaBVRlEv+mtz2Q/8nso2ipDvEmqwR3M3/aKXWx/BqXDb+4avmyob9Pphcxew2aSrLeJJj1K9tPyu1KjHN1tsuDplCHy6nfUlfCWTksfGKl2Yf1XzY54gb/FUkLcj105/JGq7Jxn27+QBMc12Om2uc1GHA6JKOKaMsbPBcXj53gAKGWnmKFTQ3RNJiwKbilgLaO7xJWSubh/2LsLCkpNBzvv95bTrX1mLL7UmkAWYh22IXYkC2pXW5ecgb5Pe/JkQwh/7tgIl//4PVklPWsiuL8CF1dH0rXrJ6UeTI6UPE6QxH+UiG+SJ8BqXsEFKRHn0fgnfDLL0XBcC5ZtWWWXXHTLTSTipRI69Lszpm5AWeyvyZgR+RedJDlBZVheL1LisyobnQZB8ZN/8XCYX1WYBjQ/93yBnRdB/SOZm2nXfLG/5bMEDUvzbDQmzDemYz/ChaEvX4wnvKzAIML1KQdmMJI59KJfhJ3vunODlbOvUG6IoqyDwoiI8g2VX9UdxtChgN9No3qkpDDD7JabBj2ZUg+RoXcE8SCIEy7F3t17g4FE/LrK5q6K4CHjCuo2qFg1rqtco2CKO5VbkIdFhMJk+xyxFrOj8Yz4KpjrfUa4nIJ3Sk663VstK9msUhvzd70UbG/G888V3XLswNQTthNAna+0kSaqcN4lNkAP2flP7IAoYNTNIGZLf2nmh1/MP6vwrcKR98PZKfHtXTQ4KwGsKdwgNM4R2GrdYacEWwPYcWj55C6JsO+I3ChwRy76OQAvPfjMOG2UCOZXKzKAxUpC23J6795pDLmwPbJIeE2thndfxUzAa0TjPl4yrOIPvsTYKMurp1kwvY6HfLsTjLD0CgmGB2O3/Iafbyf2WAzUHiZDVHYCV3e20s2ckRIcYeLSmqHUjCcDi3m8CTp1KfnsLnFM6wUFxm7U+ooEbDWXN7HPy07v3YHX1MeXFRqSlo03YKFwUniHPNO1EP/FORLLEK4yt767QoPeQdyOTyu1f43vdHZm8bnRBVzIrX6HfLzGDntgDHRbBOwmgw61RiaD1oZxzSi9gvFlajEpRVcpij9+DfZ7BNP1scg51xU13InXXGkHJBgKvRgvYJze9ClsNF+fDlTbMFl7/QR2TpGdN96JUeSoxagG3LgxSEEQ/yiy1m+nVKoulVTGTGq1ErOvRI5n0uVthWl+0HMeEfFchddOD0tHr6gOOF++OfTTvaC8TA8wIq0KdzcD/hXzWotAygLsUAuxK/EW95/a7mmaq7DQ2VCmDSVGYF1WJBHc= var onError = function(error) { document.getElementById(\"enc_error\").innerHTML = \"password error!\" }; function decrypt() { var passwd = document.getElementById(\"enc_pwd_input\").value; console.log(passwd); doDecrypt(passwd, onError); }","categories":[{"name":"test","slug":"test","permalink":"http://showteeth.tech/categories/test/"}],"tags":[{"name":"password","slug":"password","permalink":"http://showteeth.tech/tags/password/"}]},{"title":"test_templete2","slug":"test-templete","date":"2019-02-16T15:38:36.000Z","updated":"2019-02-17T11:19:49.821Z","comments":true,"path":"posts/37746.html","link":"","permalink":"http://showteeth.tech/posts/37746.html","excerpt":"Abstract: 测试创建博客模板","text":"Abstract: 测试创建博客模板this is contentthis is sub title“百度”二字，来自于八百年前南宋词人辛弃疾的一句词：众里寻他千百度。这句话描述了词人对理想的执着追求。1999年底，身在美国硅谷的李彦宏看到了中国互联网及中文搜索引擎服务的巨大发展潜力，抱着技术改变世界的梦想，他毅然辞掉硅谷的高薪工作，携搜索引擎专利技术，于 2000年1月1日在中关村创建了百度公司。","categories":[{"name":"test","slug":"test","permalink":"http://showteeth.tech/categories/test/"}],"tags":[{"name":"templete","slug":"templete","permalink":"http://showteeth.tech/tags/templete/"}]},{"title":"test-top","slug":"test-top","date":"2019-02-14T16:00:00.000Z","updated":"2019-02-19T06:25:34.245Z","comments":true,"path":"posts/48109.html","link":"","permalink":"http://showteeth.tech/posts/48109.html","excerpt":"Abstract: 测试置顶操作","text":"Abstract: 测试置顶操作this is titlethis is subtitle","categories":[{"name":"test","slug":"test","permalink":"http://showteeth.tech/categories/test/"}],"tags":[{"name":"top","slug":"top","permalink":"http://showteeth.tech/tags/top/"}]},{"title":"test-top2","slug":"test-top2","date":"2019-02-14T16:00:00.000Z","updated":"2019-02-19T06:25:45.604Z","comments":true,"path":"posts/39162.html","link":"","permalink":"http://showteeth.tech/posts/39162.html","excerpt":"Abstract: 测试置顶标签2","text":"Abstract: 测试置顶标签2this is titlethis is subtitle","categories":[{"name":"test","slug":"test","permalink":"http://showteeth.tech/categories/test/"}],"tags":[{"name":"top","slug":"top","permalink":"http://showteeth.tech/tags/top/"}]},{"title":"四种方法实现数据双向绑定","slug":"四种方法实现数据双向绑定","date":"2018-05-10T03:29:08.000Z","updated":"2019-02-18T17:02:57.141Z","comments":true,"path":"posts/12160.html","link":"","permalink":"http://showteeth.tech/posts/12160.html","excerpt":"前言在一些前端框架中，例如 angular，vue都有数据双向数据绑定的功能，这个功能极大的方便我们操作数据。那么接下来我会讲解一下双向数据绑定的4种实现方式。","text":"前言在一些前端框架中，例如 angular，vue都有数据双向数据绑定的功能，这个功能极大的方便我们操作数据。那么接下来我会讲解一下双向数据绑定的4种实现方式。方式1.手动触发绑定手动触发绑定的主要思路是通过在数据对象定义 get 和 set 方法(可以使用其他的命名方法)，调用时手动去触发 get 和 set 方法去获取数据，修改数据，改变数据后会主动去触发 get 和 set 函数中视图层的重新渲染。简单的手动触发绑定代码如下：1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;手动双向绑定&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;input type=\"text\" id=\"input\" s-value=\"value\"&gt; &lt;span id=\"el\" s-text=\"value\"&gt;&lt;/span&gt; &lt;script&gt; let elems = [document.getElementById('el'), document.getElementById('input')]; let data = &#123; value: '' &#125; let directive = &#123; text: function (text) &#123; this.innerHTML = text &#125;, value: function (value) &#123; this.setAttribute('value', value) &#125; &#125; // 监听 input 的 keyup 事件 elems[1].addEventListener('keyup', function (e) &#123; set('value', e.target.value) &#125;) function scan() &#123; for (let elem of elems) &#123; for (let attr of elem.attributes) &#123; if (attr.nodeName.indexOf('s-') !== -1) &#123; // 调用属性指令 directive[attr.nodeName.slice(2)].call(elem, data[attr.nodeValue]) &#125; &#125; &#125; &#125; function set(key, value) &#123; data[key] = value; scan(); &#125; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;2.数据劫持数据劫持的基本思路是使用 Object.defineProperty 对 ViewModel 数据对象进行 get 和 set 的监听，当有数据变动的时候扫描元素节点，然后去运行对应节点上的指令（directive）。代码如下：12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;数据劫持&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;input type=\"text\" id=\"input\" s-value=\"value\"&gt; &lt;span id=\"el\" s-text=\"value\"&gt;&lt;/span&gt; &lt;script&gt; let elems = [document.getElementById('el'), document.getElementById('input')]; let data = &#123; value: '' &#125; let directive = &#123; text: function (text) &#123; this.innerHTML = text &#125;, value: function (value) &#123; this.setAttribute('value', value) &#125; &#125; let value; defineGetAndSet(data, 'value') // 监听 input 的 keyup 事件 elems[1].addEventListener('keyup', function (e) &#123; data.value = e.target.value; &#125;) function scan() &#123; for (let elem of elems) &#123; for (let attr of elem.attributes) &#123; if (attr.nodeName.indexOf('s-') !== -1) &#123; // 调用属性指令 directive[attr.nodeName.slice(2)].call(elem, data[attr.nodeValue]) &#125; &#125; &#125; &#125; function defineGetAndSet(obj, attrName) &#123; Object.defineProperty(obj, attrName, &#123; get: function () &#123; return value &#125;, set: function (newValue) &#123; value = newValue; scan() &#125;, configurable: true, enumerable: true &#125;) &#125; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;3.使用 es6的 Proxy利用Proxy ，它可以目标对象之前架设一层“拦截”，外界对该对象的访问，都必须先通过这层拦截，因此可以对外界的访问进行过滤和改写，实现数据双向数据绑定和上一个类似。代码如下：12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;使用 proxy 进行数据双向绑定&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;input type=\"text\" id=\"input\" s-value=\"value\"&gt; &lt;span id=\"el\" s-text=\"value\"&gt;&lt;/span&gt; &lt;script&gt; let elems = [document.getElementById('el'), document.getElementById('input')]; let directive = &#123; text: function (text) &#123; this.innerHTML = text &#125;, value: function (value) &#123; this.setAttribute('value', value) &#125; &#125; // ------------- 看下面 ------------- let data = new Proxy(&#123;&#125;, &#123; get: function (target, key, receiver) &#123; return target.value &#125;, set(target, key, value, receiver) &#123; target.value = value; scan(); &#125; &#125;) // ------------- 看上面 ------------- // 监听 input 的 keyup 事件 elems[1].addEventListener('keyup', function (e) &#123; data.value = e.target.value; &#125;) function scan() &#123; for (let elem of elems) &#123; for (let attr of elem.attributes) &#123; if (attr.nodeName.indexOf('s-') !== -1) &#123; // 调用属性指令 directive[attr.nodeName.slice(2)].call(elem, data[attr.nodeValue]) &#125; &#125; &#125; &#125; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;4. 脏检查脏检查的基本原理是在 ViewModel 对象的某个属性值发生变化的时候找到与这个属性值相关的所有元素，然后去比较数据变化，如果变化就用 directive 指令调用，对这个元素进行重新渲染。简单的脏检查代码如下：12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;脏检查&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;input type=\"text\" id=\"input\" s-bind=\"value\" s-event=\"value\"&gt; &lt;span id=\"el\" s-event=\"text\" s-bind=\"value\"&gt;&lt;/span&gt; &lt;script&gt; let elems = [document.getElementById('el'), document.getElementById('input')]; let directives = &#123; text: function (text) &#123; this.innerHTML = text &#125;, value: function (value) &#123; this.setAttribute('value', value) &#125; &#125; let data = &#123; value: '' &#125; // 扫描元素，使每个元素的 directive 数组为空 scan(elems) // 监听 input 的 keyup 事件 elems[1].addEventListener('keyup', function (e) &#123; data.value = e.target.value; startDirtyCheck(e.target.getAttribute('s-bind')) &#125;) function scan() &#123; for (let elem of elems) &#123; elem.directive = [] &#125; &#125; // 开启脏检查 function startDirtyCheck(value) &#123; let list = document.querySelectorAll('[s-bind=' + value + ']') dirtyCheck(list) &#125; function dirtyCheck(elems) &#123; // 扫描带指令的节点属性 for (let i = 0, len = elems.length; i &lt; len; i++) &#123; let elem = elems[i]; for (let j = 0, len1 = elem.attributes.length; j &lt; len1; j++) &#123; let attr = elem.attributes[j]; if (attr.nodeName.indexOf('s-event') !== -1) &#123; let dataKey = elem.getAttribute('s-bind') // 进行脏数据检查，如果数据改变，重新执行指令 if (elem.directive[attr.nodeValue] !== data[dataKey]) &#123; directives[attr.nodeValue].call(elem, data[dataKey]) elem.directive[attr.nodeValue] = data[dataKey] &#125; &#125; &#125; &#125; &#125; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;","categories":[{"name":"前端","slug":"前端","permalink":"http://showteeth.tech/categories/前端/"}],"tags":[{"name":"前端","slug":"前端","permalink":"http://showteeth.tech/tags/前端/"},{"name":"js","slug":"js","permalink":"http://showteeth.tech/tags/js/"}]}]}